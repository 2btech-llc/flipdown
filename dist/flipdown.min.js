"use strict";function FlipDown(a,b){this.version="0.1.3",this.initialised=!1,this.now=this.getTime(),this.epoch=a,this.countdownEnded=0>this.epoch-this.now,this.element=document.getElementById(b),this.rotors=[],this.rotorLeafFront=[],this.rotorLeafRear=[],this.rotorTops=[],this.rotorBottoms=[],this.countdown=null,this.daysRemaining=0,this.clockValues={},this.clockStrings={},this.clockValuesAsString=[],this.prevClockValuesAsString=[],console.log("FlipDown "+this.version)}FlipDown.prototype.start=function(){return this.initialised||this.init(),this.countdown=setInterval(this.tick.bind(this),1e3),this},FlipDown.prototype.ifEnded=function(a){return a(),this},FlipDown.prototype.getTime=function(){return new Date().getTime()/1e3},FlipDown.prototype.init=function(){var a=Math.floor;this.initialised=!0,this.daysremaining=this.countdownEnded?0:a((this.epoch-this.now)/86400).toString().length;for(var b=2>=this.daysremaining?2:this.daysremaining,c=0;c<b+6;c++)this.rotors.push(this.createRotor(0));for(var d=[],c=0;c<b;c++)d.push(this.rotors[c]);this.element.appendChild(this.createRotorGroup(d));for(var e,f=b,c=0;3>c;c++){e=[];for(var g=0;2>g;g++)e.push(this.rotors[f]),f++;this.element.appendChild(this.createRotorGroup(e))}return this.rotorLeafFront=Array.from(document.getElementsByClassName("rotor-leaf-front")),this.rotorLeafRear=Array.from(document.getElementsByClassName("rotor-leaf-rear")),this.rotorTop=Array.from(document.getElementsByClassName("rotor-top")),this.rotorBottom=Array.from(document.getElementsByClassName("rotor-bottom")),this.tick(),this.updateClockValues(!0),this},FlipDown.prototype.createRotorGroup=function(a){var b=document.createElement("div");b.className="rotor-group";var c=document.createElement("div");return c.className="rotor-group-heading",b.appendChild(c),appendChildren(b,a),b},FlipDown.prototype.createRotor=function(a){var b=document.createElement("div"),c=document.createElement("div"),d=document.createElement("figure"),e=document.createElement("figure"),f=document.createElement("div"),g=document.createElement("div");return b.className="rotor",c.className="rotor-leaf",d.className="rotor-leaf-rear",e.className="rotor-leaf-front",f.className="rotor-top",g.className="rotor-bottom",d.textContent=a,f.textContent=a,g.textContent=a,appendChildren(b,[c,f,g]),appendChildren(c,[d,e]),b},FlipDown.prototype.tick=function(){var a=Math.floor;this.now=this.getTime();var b=0>=this.epoch-this.now?0:this.epoch-this.now;this.clockValues.d=a(b/86400),b-=86400*this.clockValues.d,this.clockValues.h=a(b/3600),b-=3600*this.clockValues.h,this.clockValues.m=a(b/60),b-=60*this.clockValues.m,this.clockValues.s=a(b),this.updateClockValues()},FlipDown.prototype.updateClockValues=function(){function a(){var a=this;this.rotorTop.forEach(function(b,c){b.textContent!=a.clockValuesAsString[c]&&(b.textContent=a.clockValuesAsString[c])})}function b(){var a=this;this.rotorLeafRear.forEach(function(b,c){if(b.textContent!=a.clockValuesAsString[c]){b.textContent=a.clockValuesAsString[c],b.parentElement.classList.add("flipped");var d=setInterval(function(){b.parentElement.classList.remove("flipped"),clearInterval(d)}.bind(a),500)}})}var c=this,d=!!(0<arguments.length&&arguments[0]!==void 0)&&arguments[0];this.clockStrings.d=pad(this.clockValues.d,2),this.clockStrings.h=pad(this.clockValues.h,2),this.clockStrings.m=pad(this.clockValues.m,2),this.clockStrings.s=pad(this.clockValues.s,2),this.clockValuesAsString=(this.clockStrings.d+this.clockStrings.h+this.clockStrings.m+this.clockStrings.s).split(""),this.rotorLeafFront.forEach(function(a,b){a.textContent=c.prevClockValuesAsString[b]}),this.rotorBottom.forEach(function(a,b){a.textContent=c.prevClockValuesAsString[b]}),d?(a.call(this),b.call(this)):(setTimeout(a.bind(this),500),setTimeout(b.bind(this),500)),this.prevClockValuesAsString=this.clockValuesAsString};function pad(a,b){return a=a.toString(),a.length<b?pad("0"+a,b):a}function appendChildren(a,b){b.forEach(function(b){a.appendChild(b)})}
